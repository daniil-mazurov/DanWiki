>[!important] imports
>```python
>from sqlalchemy.ext.asyncio import create_async_engine
>from sqlalchemy import create_engine, text
>```


> [!info] Императивный и декларативный стили (Core и ORM)
> - **Императивный стиль** (Core) работы с базой данных позволяет писать SQL-подобный код, отправляемый через создаваемые соединения (**engine**), что минимизирует количество запросов и увеличивает читаемость кода
> - **Декларативный стиль** (ORM) подразумевает разработку объектно-ориентированного кода, где объекты базы данных представляются объектами классов Python, что увеличивает количество запросов и понижает читаемость кода, однако повышает гибкость обработки данных и позволяет работать в режиме сессии (**Session**)

# engine
#### create_engine(), create_async_engine()

^b25557

- **url**=settings.DATABASE_URL,
- **echo**=True, # Логирование всех выполняемых операций
- **pool_size**=5, # Максимальное количество подключений к базе
- **max_overflow**=10, # Количество дополнительных подключений при переполнении
 Создание движка для подключения к базе
#### connect()
- Реализация подключения
```python
with engine.connect() as conn:
	res = conn.execute(text("SELECT VERSION()"))
```
- Асинхронно
```python
async def async_connect():
	async with async_engine.connect() as conn:
		res = await conn.execute(text("SELECT 1,2,3"))
```
##### res.first(), res.all()
- first()
	Вывод первой строки полученных данных
- all()
	Вывод списка всех строк
Оба метода получают и обрабатывают все данные, отличается лишь вывод
##### text()
- Обертка для текстового SQL запроса
#### begin()
- Реализация подключения (Аналог сonnect, однако неявно выполняется commit)
#### conn.commit()
	Внесение изменений инициированных в транзакции в базу данных
# session
>[!important] imports
>```python
>from sqlalchemy.orm import Session, sessionmaker
>from sqlalchemy.ext.asyncio import AsyncSession, async_sessionmaker
>```

Session - инструмент для создания транзакции и выполнения группы запросов, позволяющий делать промежуточную загрузку данных в базу
## session.flush()
Производит загрузку объектов данных в базу, в результате чего осуществляются действия аналогичные `commit`, что позволяет, например, получить первичный ключ объекта (или другие генерирующиеся данные)
## session.expire(data_obj), session.expire_all()
Производит отмену изменений объектов данных в базе произведенных за текущую сессию
## session.refresh(data_obj)
Заменяет текущие данные объекта текущими, находящимися в базе данных (обновляет)
## sessionmaker(engine), async_sessionmaker(async_engine)
- Фабрика сессий, задающая постоянные параметры (например, engine).
Фабрика используется вместо engine для подключения к базе в формате непрерывной сессии